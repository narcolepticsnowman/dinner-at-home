<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Menu</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://www.gstatic.com/firebasejs/7.9.3/firebase-app.js"></script>

    <script src="https://www.gstatic.com/firebasejs/7.9.3/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.9.3/firebase-firestore.js"></script>
    <script src="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.css"/>
    <script type="text/javascript">
        const firebaseConfig = {
            apiKey: "AIzaSyDmaQbkeo-pYMRbV2jiealTpjMTpTPH2kk",
            authDomain: "dinner-at-home.firebaseapp.com",
            databaseURL: "https://dinner-at-home.firebaseio.com",
            projectId: "dinner-at-home",
            storageBucket: "dinner-at-home.appspot.com",
            messagingSenderId: "601450421542",
            appId: "1:601450421542:web:12f21f11c9bbbfe5c135e7",
            measurementId: "G-FC4WQX18R8"
        }
        firebase.initializeApp(firebaseConfig);

    </script>
</head>
<body>
<script type="module">
    import {fnapp, fnbind, fnstate} from './fntags.js'
    import {div, style} from './fnelements.js'
    import MenuBoard from "./MenuBoard.js";
    import {today} from "./constants.js";

    const firebaseUser = fnstate({current: {}})

    document.head.append(
        style(`
            body {
                background-image: url(./chalkboardBackground.jpg);
                background-position: center;
                background-size: cover;
                min-height: 100vh;
                font-family: radium;
            }
            @font-face {
                font-family: 'radium';
                src: url('radium.woff') format('woff');
            }
            button {
                background-color: grey;
                border-color: black;
                border-radius: 4px;
                padding: 10px;
                font-family: radium;
            }
        `)
    )

    fnapp(document.body,
        fnbind(firebaseUser, ()=> firebaseUser.current ? div(
            {
                style: {
                    margin: 'auto',
                    'align-items': 'center',
                    padding: '10px',
                    display: 'flex',
                    'flex-direction': 'column',
                    'max-width': '650px',
                    'text-align': 'center'
                }
            },
            MenuBoard()
            ) : ''
        )
    )

    firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
            firebaseUser.current = user
        } else {
            firebase.auth().getRedirectResult().then(function (result) {
                firebaseUser.current = result.user
                if (!firebaseUser.current) {
                    let provider = new firebase.auth.GoogleAuthProvider();
                    firebase.auth().signInWithRedirect(provider);
                }
            }).catch(console.error);
        }
    });

</script>
</body>
</html>